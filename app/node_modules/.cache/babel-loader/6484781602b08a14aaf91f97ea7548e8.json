{"ast":null,"code":"import _toConsumableArray from\"C:/Riff-Raffle-Solana-NFT build 1-1/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Riff-Raffle-Solana-NFT build 1-1/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Riff-Raffle-Solana-NFT build 1-1/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Riff-Raffle-Solana-NFT build 1-1/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button,IconButton,Typography}from'@material-ui/core';import{Refresh}from'@material-ui/icons';import{SYSVAR_RECENT_BLOCKHASHES_PUBKEY}from'@solana/web3.js';import{useCallback,useEffect,useState}from'react';import{useParams}from'react-router';import Screen from'../../../components/layout/Screen';import Spacer from'../../../components/Spacer';import{useProgramApis}from'../../../hooks/useProgramApis';import{useRafflesStore}from'../../../hooks/useRafflesStore';import{txHandler}from'../../../lib/anchorUtils';import{useStyles}from'./styles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AdminRaffleScreen=function AdminRaffleScreen(){var classes=useStyles();var _useParams=useParams(),raffleId=_useParams.id;var _useRafflesStore=useRafflesStore(),raffles=_useRafflesStore.raffles,updateRaffleById=_useRafflesStore.updateRaffleById;var _useProgramApis=useProgramApis(),draffleClient=_useProgramApis.draffleClient;var _useState=useState(),_useState2=_slicedToArray(_useState,2),currentRaffle=_useState2[0],setCurrentRaffle=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];useEffect(function(){var raffle=raffles.get(raffleId);if(raffle)setCurrentRaffle(raffle);},[raffles,raffleId]);var revealWinners=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return txHandler(function(){return draffleClient.rpc.revealWinners({accounts:{raffle:raffleId,recentBlockhashes:SYSVAR_RECENT_BLOCKHASHES_PUBKEY}});},'Raffle revealed');case 2:case\"end\":return _context.stop();}}},_callee);})),[draffleClient,raffleId]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsx(Typography,{variant:\"h3\",children:\"Loading...\"})});}if(!currentRaffle)return null;return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,children:[currentRaffle?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.headerContainer,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h3\",children:[\"Entrants list (total \",currentRaffle.entrants.size,\")\"]}),/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){setLoading(true);updateRaffleById(raffleId);setLoading(false);},children:/*#__PURE__*/_jsx(Refresh,{})}),/*#__PURE__*/_jsx(Button,{onClick:revealWinners,variant:\"contained\",children:\"Reveal winners\"})]}),/*#__PURE__*/_jsx(Spacer,{height:'20px'}),_toConsumableArray(currentRaffle.entrants.entries()).map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),wallet=_ref3[0],tickets=_ref3[1];return/*#__PURE__*/_jsxs(\"div\",{className:classes.entrantRow,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",children:[wallet,\": \"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:tickets.tickets.toString()})]},wallet);})]}):/*#__PURE__*/_jsx(Typography,{variant:\"h3\",children:\"No entrants\"}),/*#__PURE__*/_jsx(Spacer,{height:'50px'})]});};var AdminRaffleScreenWithLayout=function AdminRaffleScreenWithLayout(){return/*#__PURE__*/_jsx(Screen,{children:/*#__PURE__*/_jsx(AdminRaffleScreen,{})});};export default AdminRaffleScreenWithLayout;","map":null,"metadata":{},"sourceType":"module"}