{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/kroni/Desktop/RIFF RAFFLE SITE PNSC/Riff-Raffle-Solana-NFT final/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/kroni/Desktop/RIFF RAFFLE SITE PNSC/Riff-Raffle-Solana-NFT final/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/kroni/Desktop/RIFF RAFFLE SITE PNSC/Riff-Raffle-Solana-NFT final/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/kroni/Desktop/RIFF RAFFLE SITE PNSC/Riff-Raffle-Solana-NFT final/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import{Provider}from'@project-serum/anchor';import toast from'react-hot-toast';import{sleep}from'./utils';export var StubWallet=/*#__PURE__*/function(){function StubWallet(){_classCallCheck(this,StubWallet);this.publicKey=undefined;}_createClass(StubWallet,[{key:\"signTransaction\",value:function(){var _signTransaction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(tx){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",tx);case 1:case\"end\":return _context.stop();}}},_callee);}));function signTransaction(_x){return _signTransaction.apply(this,arguments);}return signTransaction;}()},{key:\"signAllTransactions\",value:function(){var _signAllTransactions=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(txs){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",txs);case 1:case\"end\":return _context2.stop();}}},_callee2);}));function signAllTransactions(_x2){return _signAllTransactions.apply(this,arguments);}return signAllTransactions;}()// Hack so that the stub is not recognised as a connected user down the track\n}]);return StubWallet;}();export var customProviderFactory=function customProviderFactory(connection,anchorWallet){var provider=new Provider(connection,anchorWallet||new StubWallet(),{});// No websocket sender with tx confirmation awaiting\nprovider.send=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(tx,signers,opts){var rawTx,signature,i,signatureStatus;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(signers===undefined){signers=[];}tx.feePayer=anchorWallet===null||anchorWallet===void 0?void 0:anchorWallet.publicKey;_context3.next=4;return connection.getRecentBlockhash();case 4:tx.recentBlockhash=_context3.sent.blockhash;_context3.next=7;return anchorWallet===null||anchorWallet===void 0?void 0:anchorWallet.signTransaction(tx);case 7:signers.filter(function(s){return s!==undefined;}).forEach(function(kp){tx.partialSign(kp);});rawTx=tx.serialize();_context3.next=11;return connection.sendRawTransaction(rawTx);case 11:signature=_context3.sent;i=0;case 13:if(!(i<30)){_context3.next=24;break;}_context3.next=16;return connection.getSignatureStatus(signature);case 16:signatureStatus=_context3.sent.value;if(!((signatureStatus===null||signatureStatus===void 0?void 0:signatureStatus.confirmationStatus)==='confirmed')){_context3.next=19;break;}return _context3.abrupt(\"break\",24);case 19:_context3.next=21;return sleep(1000);case 21:i++;_context3.next=13;break;case 24:return _context3.abrupt(\"return\",signature);case 25:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3,_x4,_x5){return _ref.apply(this,arguments);};}();return provider;};// Allows generic wrapping of rpc calls to elevate success and errors to the user\nexport var txHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(rpcFc,successMessage){var signature;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return rpcFc();case 3:signature=_context4.sent;console.log('Success:',signature);toast.success(successMessage);return _context4.abrupt(\"return\",true);case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);if(_context4.t0.msg){toast.error(\"Transaction failed: \".concat(_context4.t0.msg));}else{toast.error('Unexpected error');}return _context4.abrupt(\"return\",false);case 14:case\"end\":return _context4.stop();}}},_callee4,null,[[0,9]]);}));return function txHandler(_x6,_x7){return _ref2.apply(this,arguments);};}();","map":null,"metadata":{},"sourceType":"module"}