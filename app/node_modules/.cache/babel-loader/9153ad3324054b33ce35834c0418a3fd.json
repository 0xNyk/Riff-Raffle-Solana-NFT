{"ast":null,"code":"import _toConsumableArray from\"C:/Users/kroni/Desktop/RIFF RAFFLE SITE PNSC/Riff-Raffle-Solana-NFT/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/kroni/Desktop/RIFF RAFFLE SITE PNSC/Riff-Raffle-Solana-NFT/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Card,Grid,IconButton,Typography}from'@material-ui/core';import{useWallet}from'@solana/wallet-adapter-react';import{useEffect,useState}from'react';import{useHistory}from'react-router';import{Add}from'@material-ui/icons';import{PublicKey,SystemProgram,SYSVAR_RENT_PUBKEY}from'@solana/web3.js';import{TOKEN_PROGRAM_ID}from'@solana/spl-token';import BN from'bn.js';import Screen from'../../../components/layout/Screen';import WalletButton from'../../../components/layout/WalletButton';import Spacer from'../../../components/Spacer';import{useRafflesStore}from'../../../hooks/useRafflesStore';import{useProgramApis}from'../../../hooks/useProgramApis';import{routes}from'../../../router/routes';import{useStyles}from'./styles';import{DISPENSER_REGISTRY_ADDRESS,DISPENSER_REGISTRY_KEYPAIR}from'../../../config/programIds';import{shortenPubkeyString}from'../../../lib/utils';import{VAULT_TOKEN_IN,VAULT_TOKEN_OUT}from'../../../config/accounts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AdminHomeScreen=function AdminHomeScreen(){var classes=useStyles();var _useWallet=useWallet(),connected=_useWallet.connected;var _useHistory=useHistory(),push=_useHistory.push;var _useRafflesStore=useRafflesStore(),raffles=_useRafflesStore.raffles,fetchAllRaffles=_useRafflesStore.fetchAllRaffles;var _useProgramApis=useProgramApis(),dispenserClient=_useProgramApis.dispenserClient;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),dispensers=_useState2[0],setDispensers=_useState2[1];useEffect(function(){fetchAllRaffles(true);},[fetchAllRaffles]);useEffect(function(){dispenserClient.account.registry.all().then(setDispensers);},[dispenserClient,setDispensers]);return/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:connected?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'row',justifyContent:'center',alignItems:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",children:\"Dispensers\"}),/*#__PURE__*/_jsx(IconButton,{size:'small',onClick:function onClick(){dispenserClient.rpc.createRegistry(new BN(500000000),new BN(1000000),{accounts:{registry:DISPENSER_REGISTRY_ADDRESS,vaultTokenIn:VAULT_TOKEN_IN,vaultTokenOut:VAULT_TOKEN_OUT,admin:dispenserClient.provider.wallet.publicKey,mintTokenIn:new PublicKey('So11111111111111111111111111111111111111112'),mintTokenOut:new PublicKey('zRpVjG5wMWrNhpTtSiGMz9iBaMTQDdaVGCFLmYqCs4U'),tokenProgram:TOKEN_PROGRAM_ID,systemProgram:SystemProgram.programId,rent:SYSVAR_RENT_PUBKEY},signers:[DISPENSER_REGISTRY_KEYPAIR]}).then(function(res){return console.log(res);});},children:/*#__PURE__*/_jsx(Add,{className:classes.scrollButtonIcon})})]}),/*#__PURE__*/_jsx(Spacer,{height:'20px'}),dispensers.length===0?/*#__PURE__*/_jsx(_Fragment,{children:\"No dispenser found.\"}):/*#__PURE__*/_jsx(Grid,{container:true,spacing:1,className:classes.raffleGrid,children:dispensers.map(function(dispenser){return/*#__PURE__*/_jsx(Grid,{item:true,xs:3,spacing:3,className:classes.raffleGridItem,children:/*#__PURE__*/_jsxs(Card,{className:classes.raffleCard,children:[/*#__PURE__*/_jsxs(Typography,{children:[\"Admin: \",shortenPubkeyString(dispenser.account.admin)]}),/*#__PURE__*/_jsxs(Typography,{children:[\"In: \",shortenPubkeyString(dispenser.account.mintTokenIn)]}),/*#__PURE__*/_jsxs(Typography,{children:['->',\" Vault:\",' ',shortenPubkeyString(dispenser.account.vaultTokenIn)]}),/*#__PURE__*/_jsxs(Typography,{children:[\"Out: \",shortenPubkeyString(dispenser.account.mintTokenOut)]}),/*#__PURE__*/_jsxs(Typography,{children:['->',\" Vault:\",' ',shortenPubkeyString(dispenser.account.vaultTokenOut)]})]})},dispenser.publicKey.toString());})}),/*#__PURE__*/_jsx(Spacer,{height:'20px'}),/*#__PURE__*/_jsx(Typography,{variant:\"h3\",children:\"Ongoing raffles\"}),/*#__PURE__*/_jsx(Spacer,{height:'20px'}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:1,className:classes.raffleGrid,children:_toConsumableArray(raffles.values()).filter(function(raffle){return new Date()<=raffle.endTimestamp;}).map(function(raffle){return/*#__PURE__*/_jsx(Grid,{item:true,xs:3,spacing:3,className:classes.raffleGridItem,children:/*#__PURE__*/_jsxs(Card,{className:classes.raffleCard,onClick:function onClick(){return push(\"\".concat(routes.ADMIN.RAFFLES,\"/\").concat(raffle.publicKey));},children:[/*#__PURE__*/_jsx(Typography,{children:raffle.metadata.name}),/*#__PURE__*/_jsx(Typography,{children:/*#__PURE__*/_jsx(Typography,{children:raffle.endTimestamp.toISOString()})})]})});})}),/*#__PURE__*/_jsx(Spacer,{height:'50px'}),/*#__PURE__*/_jsx(Typography,{variant:\"h3\",children:\"Ended raffles\"}),/*#__PURE__*/_jsx(Spacer,{height:'20px'}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:1,className:classes.raffleGrid,children:_toConsumableArray(raffles.values()).filter(function(raffle){return new Date()>raffle.endTimestamp;}).map(function(raffle){return/*#__PURE__*/_jsx(Grid,{item:true,xs:3,spacing:3,className:classes.raffleGridItem,children:/*#__PURE__*/_jsxs(Card,{className:classes.raffleCard,onClick:function onClick(){return push(\"\".concat(routes.ADMIN.RAFFLES,\"/\").concat(raffle.publicKey));},children:[/*#__PURE__*/_jsx(Typography,{children:raffle.metadata.name}),/*#__PURE__*/_jsx(Typography,{children:raffle.endTimestamp.toISOString()})]})},raffle.publicKey.toString());})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",children:\"Connect with an admin wallet to unlock admin panel\"}),/*#__PURE__*/_jsx(\"div\",{className:classes.walletButtonContainer,children:/*#__PURE__*/_jsx(WalletButton,{})})]})});};var AdminHomeScreenWithLayout=function AdminHomeScreenWithLayout(){return/*#__PURE__*/_jsx(Screen,{children:/*#__PURE__*/_jsx(AdminHomeScreen,{})});};export default AdminHomeScreenWithLayout;","map":null,"metadata":{},"sourceType":"module"}